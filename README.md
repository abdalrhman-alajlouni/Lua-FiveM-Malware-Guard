<br/>
<p align="center">
    Lua-FiveM-Malware-Guard


  <p align="center">
    Lua FiveM Malware Guard: A powerful resources extension for FiveM servers owners to enhance server security by preventing unauthorized Lua functions, managing resource permissions, and receiving real-time alerts via Discord webhooks.
    <br/>
    <br/>

  </p>
</p>

<div align="center">

![Downloads](https://img.shields.io/github/downloads/abdalrhman-alajlouni/Lua-FiveM-Malware-Guard/total)
![Contributors](https://img.shields.io/github/contributors/abdalrhman-alajlouni/Lua-FiveM-Malware-Guard?color=dark-green)
![Issues](https://img.shields.io/github/issues/abdalrhman-alajlouni/Lua-FiveM-Malware-Guard)
![License](https://img.shields.io/github/license/abdalrhman-alajlouni/Lua-FiveM-Malware-Guard)

</div>

# About
Lua FiveM Malware Guard is a security-focused resources extension for FiveM servers owners. It is designed to prevent the usage of Lua functions such as os.execute, os.getenv, io.popen etc., and sensitive FiveM native functions in resources, and it allows the server owner to assign permissions to each resource to specify which functions are allowed. The resource also includes a Discord webhook system for alerting administrators of trigger attempts, with three levels of alerts: normal, high, and very high.

# Table of Contents

- [Demo](#-demo)
- [Features](#-features)
- [Usage Steps](#-usage-steps)
- [ToDo List](#-todo-list)
- [Functions Covered](#-functions-covered)
- [How to Contribute](#-contribute)
- [Contact](#-contact)
- [License](#license)
- [Disclaimer and Limitations](#disclaimer-and-limitations)

# 🔥 Demo

### Discord Webhook Alerts.
<br>

<p align="center">
<img src="https://cdn.discordapp.com/attachments/870376559742156810/1160074631802269706/image.png" width="auto" title="log_normal">
<img src="https://cdn.discordapp.com/attachments/870376559742156810/1160074570171170896/image.png" width="auto" title="log_high">
<img src="https://cdn.discordapp.com/attachments/870376559742156810/1160074707580755999/image.png" width="auto" title="log_veryhigh">
 </p>

# 🌠 Features

- Prevent the usage of sensitive Lua functions and sensitive FiveM native functions.
- Control resource-level permissions for specific functions.
- Discord webhook integration for real-time alerts.
- Three levels of alerts (normal, high, very high).
- Zero Dependencies.
- Compatibility with All Frameworks, Whether you're using ESX, QBCore, vRP, or any other framework.
- Cross-Platform Compatibility with both Windows and Linux.
- Anti-Debugging and Override System.

# 🔨 Usage Steps

1. Locate the `citizen/scripting/resource_init.lua` file within your FiveM server build files.

2. Replace the existing `resource_init.lua` file with the one provided in this project. This ensures that the `protection.lua` file is loaded for all resources on your server.

3. Navigate to the specific resource you want to protect.

4. Add the `protection.lua` file to the resource folder you wish to secure.

5. Open the `protection.lua` file and configure your settings, including Discord webhook URLs and the functions allowed for this script.

6. Copy the configured `protection.lua` file and paste it into any resource you want to protect. Be sure to adjust the settings as needed for each resource.



# ⚡ ToDo List
If you're interested in contributing to FiveM SecurityGuard, here are some tasks that need attention. Feel free to pick an item from the list, work on it, and submit a pull request. If you have new ideas or find issues not listed here, please open an issue to discuss them.

### Core Functionality and Security Features

- [ ] Add more functions to enhance security coverage.
- [ ] Create Client Side functions security system, By using the TriggerServerEvent native to check.
- [ ] Explore the possibility of supporting other programming languages, such as JavaScript (JS) and C#.
- [ ] Implement additional security checks for the functions.
- [ ] Enhance the permission management system.
- [ ] Address any identified security vulnerabilities or bugs.
- [ ] Investigate and fix reported bugs or issues.


# ⚙ Functions Covered
Here is a list of functions covered by Lua FiveM Malware Guard with descriptions and links to relevant documentation:

### Lua Functions

1. `io.popen`
   - Description: Opens a pipe to execute a command and returns a file handle.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.popen)

2. `os.execute`
   - Description: Executes an operating system command.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-os.execute)

3. `os.clock`
   - Description: Returns an approximation of the amount in seconds of CPU time used by the program.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-os.clock)

4. `os.getenv`
   - Description: Retrieves the value of an environment variable.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-os.getenv)

5. `os.remove`
   - Description: Removes a file or directory.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-os.remove)

6. `os.rename`
   - Description: Renames a file or directory.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-os.rename)

7. `io.read`
   - Description: Reads from a file.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.read)

8. `io.open`
   - Description: Opens a file or returns a new file handle.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.open)

9. `io.close`
   - Description: Closes the given file.
   - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.close)

10. `io.input`
    - Description: Sets the default input file.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.input)

11. `io.write`
    - Description: Writes to the default output file.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.write)

12. `io.stdin`
    - Description: The standard input file.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.stdin)

13. `io.stdout`
    - Description: The standard output file.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.stdout)

14. `io.stderr`
    - Description: The standard error file.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-io.stderr)

15. `debug.getinfo`
    - Description: Retrieves information about a function.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-debug.getinfo)

16. `debug.getlocal`
    - Description: Gets information about a local variable.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-debug.getlocal)

17. `debug.getupvalue`
    - Description: Gets the value of an upvalue from a function.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-debug.getupvalue)

18. `debug.sethook`
    - Description: Sets a new hook function for debugging. The hook function can be used to trace function calls, lines of code, or other events in Lua scripts.
    - [Lua Documentation](https://www.lua.org/manual/5.4/manual.html#pdf-debug.sethook)

...

### FiveM Functions

1. `GetCurrentServerEndpoint`
   - Description: Returns the endpoint URL of the current server.
   - [FiveM Documentation](https://docs.fivem.net/natives/?_0xEA11BFBA)

2. `StartResource`
   - Description: Starts a specified resource.
   - [FiveM Documentation](https://docs.fivem.net/natives/?_0x29B440DC)

3. `StopResource`
   - Description: Stops a specified resource.
   - [FiveM Documentation](https://docs.fivem.net/natives/?_0x21783161)

4. `SetResourceKvpFloat`
   - Description: Sets a floating-point key-value pair for a resource.
   - [FiveM Documentation](https://docs.fivem.net/natives/?_0x9ADD2938)

5. `SetResourceKvpFloatNoSync`
   - Description: Sets a floating-point key-value pair for a resource without synchronizing.
   - [FiveM Documentation](https://docs.fivem.net/natives/?_0x3517BFBE)

6. `SetResourceKvpInt`
    - Description: Sets an integer key-value pair for a resource. This function is commonly used to store integer data associated with a resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x6A2B1E8)

7. `SetResourceKvpIntNoSync`
    - Description: Sets an integer key-value pair for a resource without synchronizing it across the network. Use this function when you do not need to send the update to other clients.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x26AEB707)

8. `SetResourceKvpNoSync`
    - Description: Sets a key-value pair for a resource without synchronizing it across the network. Use this function when you do not need to send the update to other clients.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xCF9A2FF)

9. `SetResourceKvp`
    - Description: Sets a key-value pair for a resource. This function allows you to store various types of data associated with a resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x21C7A35B)

10. `SetHttpHandler`
    - Description: Sets a custom HTTP handler for resource-specific HTTP requests. You can use this function to customize the behavior of HTTP requests made by your resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xF5C6330C)

11. `SetMapName`
    - Description: Sets the map name for the server. This function is used to change the displayed map name in the server browser.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xB7BA82DC)

12. `SetGameType`
    - Description: Sets the game type for the server. This function is used to change the displayed game type in the server browser.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xF90B7469)

13. `SetConvar`
    - Description: Sets the value of a convar for the server. Convars are variables used for server configuration and settings.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x341B16D2)

14. `GetConvar`
    - Description: Retrieves the value of a convar for the server. Use this function to access the value of a convar.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x6CCD2564)

15. `SetConvarReplicated`
    - Description: Sets the value of a convar for the server and replicates it to all connected clients.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xF292858C)

16. `SetConvarServerInfo`
    - Description: Sets a convar as a server info convar. Server info convars are used to display additional information about the server in the server browser.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x9338D547)

17. `SaveResourceFile`
    - Description: Saves a file within a resource. This function is used to create or update files within a resource's directory.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xA09E7E7B)

18. `GetGameName`
    - Description: Retrieves the name of the game currently being played on the server.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xE8EAA18B)

19. `GetGameBuildNumber`
    - Description: Retrieves the build number of the game currently being played on the server.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x804B9F7B)

20. `GetCurrentResourceName`
    - Description: Retrieves the name of the currently executing resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xE5E9EBBB)

21. `PerformHttpRequest`
    - Description: Performs an HTTP request from the server to a specified URL. This function allows you to make HTTP requests and handle the response.
    - [FiveM Documentation](https://docs.fivem.net/docs/scripting-reference/runtimes/lua/functions/PerformHttpRequest/)

22. `DeleteFunctionReference`
    - Description: Deletes a reference to a specific function. This function is used to remove function references created with `DuplicateFunctionReference`.
    - [FiveM Documentation](https://docs.fivem.net/natives/_0x1E86F206)

23. `DeleteResourceKvp`
    - Description: Deletes a key-value pair associated with a resource. This function removes a KVP (Key-Value Pair) associated with the current resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x7389B5DF)

24. `DeleteResourceKvpNoSync`
    - Description: Deletes a key-value pair associated with a resource without synchronizing it across the network.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x4152C90)

25. `DuplicateFunctionReference`
    - Description: Creates a duplicate reference to a specified function. This function is used to duplicate function references and store them for later use.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xF4E2079D)

26. `EnableEnhancedHostSupport`
    - Description: Enables enhanced host support for the server. This function allows for enhanced support for certain host features.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xF97B1C93)

27. `ExecuteCommand`
    - Description: Executes a console command on the server. Use this function to execute server-side console commands.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x561C060B)

28. `FlushResourceKvp`
    - Description: Flushes all key-value pairs associated with the current resource. This function removes all KVPs associated with the resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xE27C97A0)

29. `GetHashKey`
    - Description: Retrieves the hash value for a string. This function calculates a hash value for the input string.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x98EFF6F1)

30. `GetHostId`
    - Description: Retrieves the host identifier of the server. This function returns the host ID of the server.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x5F70F5A3)

31. `GetNumResources`
    - Description: Retrieves the number of loaded resources on the server. This function returns the total number of loaded resources.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x863F27B)

32. `GetPasswordHash`
    - Description: Retrieves the hashed password of a player using their server ID.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x23473EA4)

33. `GetPlayerEndpoint`
    - Description: Retrieves the endpoint (IP and port) of a player.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xFEE404F9)

34. `GetPlayerIdentifier`
    - Description: Retrieves a player's identifier (license, steam, ip, etc.) based on their server ID.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x7302DBCF)

35. `GetNumPlayerIdentifiers`
    - Description: Retrieves the number of identifiers associated with a player.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xFF7F66AB)

36. `GetNumPlayerIndices`
    - Description: Retrieves the number of player indices on the server.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x63D13184)

37. `GetNumPlayerTokens`
    - Description: Retrieves the number of player tokens (server ID) on the server.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x619E4A3D)

38. `GetNumResourceMetadata`
    - Description: Retrieves the number of metadata entries for a resource.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x776E864)

39. `GetPlayerName`
    - Description: Retrieves the name of a player based on their server ID.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x406B4B20)

40. `GetPlayerToken`
    - Description: Retrieves a player's token (server ID) based on their server ID.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x54C06897)

41. `GetResourcePath`
    - Description: Retrieves the path of a resource on the server.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x61DCF017)

42. `LoadPlayerCommerceData`
    - Description: Loads commerce data for a player.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0xA8F63EAB)

43. `LoadPlayerCommerceDataExt`
    - Description: Loads extended commerce data for a player.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x7995539E)

44. `LoadResourceFile`
    - Description: Loads a file from a resource and returns its contents as a string.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x76A9EE1F)

45. `NetworkGetEntityFromNetworkId`
    - Description: Retrieves an entity (object or ped) based on its network ID.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x5B912C3F)

46. `NetworkGetEntityOwner`
    - Description: Retrieves the owner (player) of a networked entity (object or ped).
    - [FiveM Documentation](https://docs.fivem.net/natives/networkgetentityowner)

47. `NetworkGetFirstEntityOwner`
    - Description: Retrieves the owner (player) of the first networked entity (object or ped) found.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x526FEE31)

48. `NetworkGetNetworkIdFromEntity`
    - Description: Retrieves the network ID of a networked entity (object or ped).
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x9E35DAB6)

49. `NetworkGetVoiceProximityOverride`
    - Description: Retrieves the voice proximity override level for a player.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x7A6462F4)

50. `RegisterConsoleListener`
    - Description: Registers a console command listener callback function.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x281B5448)

51. `RegisterResourceAsset`
    - Description: Registers a file or directory as a resource asset.
    - [FiveM Documentation](https://docs.fivem.net/natives/?_0x9862B266)



# ❤ Contribute

### Contributions to the Banks Data World Wide project are welcome! Follow these steps to contribute:
1. Fork the repository.
2. Create a new branch for your feature or bug fix.
3. Make your changes and test thoroughly.
4. Create a pull request with a clear description of your changes.


# 📞 Contact
- Open an Issue: If you encounter a technical issue or have a specific request related to the project.
- Compliance and Problem Reporting: For compliance-related matters or to report any problems contact via **[Email: info@m3lm.co](mailto:info@m3lm.co)**.
- Discord Community: Join **[M3LM Games vibrant Discord community](https://discord.gg/mpHTVE2Dyu)** for chatting with fellow contributors, planning and showcasing your achievements, and inquiring.

## License

[MIT](https://choosealicense.com/licenses/mit/)

## Disclaimer and Limitations

- This project, Lua FiveM Malware Guard, is intended solely for educational and informational purposes. It is designed to provide a better understanding of potential security vulnerabilities within the FiveM platform and to help prevent the misuse of certain functions. The project's creators and contributors do not endorse or encourage any illegal or unethical activities, including but not limited to hacking, cheating, or any actions that violate the terms of service of the FiveM platform or the Laws.

- Users of this project are responsible for their own actions and are expected to adhere to all applicable laws and regulations. The project's creators and contributors are not responsible for any misuse, harm, or legal consequences resulting from the use of this project.

- It is essential to use this project responsibly and ethically, respecting the rules and policies of the FiveM platform and any relevant local, state, or federal laws. If you choose to use this project, you do so at your own risk, and the project's creators and contributors shall not be held liable for any actions or consequences arising from its use.

- By using this project, you acknowledge and agree to the terms of this disclaimer. If you do not agree with these terms, you should refrain from using or contributing to this project.

